# Test scenarios for cardiology referral workflows

valid_complete_referrals:
  - scenario: "standard_referral"
    description: "Complete referral with all required information"
    messages:
      - "I need a cardiology referral"
      - "No, this is not an emergency"
      - "Dr. Sarah Johnson, NPI 1234567890, from Heart Care Medical"
      - "Patient: John Doe, DOB 01/01/1980, Phone (555) 123-4567, email: john@email.com"
      - "Chest pain for 2 weeks, currently taking metoprolol 50mg daily"
      - "Aetna insurance, Member ID: AET789012, Group: GRP123"
      - "Monday at 11am works perfectly"
    expected_outcome: "[REFERRAL_COMPLETE]"
    expected_state: "completed"
    max_turns: 8

  - scenario: "urgent_referral"
    description: "Urgent but non-emergency referral"
    messages:
      - "Need urgent cardiology consultation"
      - "Not an emergency but needs to be seen soon"
      - "Referring physician: Dr. Michael Chen from Denver Cardiology"
      - "Patient: Sarah Miller, DOB 05/22/1965, (303) 555-8888, sarah.miller@email.com"
      - "New onset atrial fibrillation, started 3 days ago, on warfarin"
      - "United Healthcare, ID: UHC456789"
      - "Thursday at 2pm if possible"
    expected_outcome: "[REFERRAL_COMPLETE]"
    expected_state: "completed"
    max_turns: 8

failure_scenarios:
  - scenario: "emergency"
    description: "Emergency requiring 911"
    messages:
      - "Having severe crushing chest pain right now"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["911", "emergency"]
    expected_state: "failed"
    max_turns: 1

  - scenario: "non_referral_question"
    description: "General medical question, not a referral"
    messages:
      - "What are the symptoms of atrial fibrillation?"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["Dr. Reed's office", "555"]
    expected_state: "failed"
    max_turns: 1

  - scenario: "provider_not_found"
    description: "Provider cannot be verified"
    messages:
      - "I need a cardiology referral"
      - "No emergency"
      - "Dr. Mohit Durve from Springfield Hospital"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["not found", "unable to verify", "cannot find"]
    max_turns: 3

  - scenario: "max_turns_exceeded"
    description: "Conversation exceeds 10-turn limit"
    messages:
      - "I need a referral"
      - "Not an emergency"
      - "I'll find that information"
      - "Give me a moment"
      - "Still looking"
      - "One second"
      - "Almost have it"
      - "Just a bit more time"
      - "Still searching"
      - "I'll get it soon"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["Dr. Reed's office", "Dr Walter"]
    expected_state: "failed"
    max_turns: 10

  - scenario: "scheduling_conflict"
    description: "Cannot accommodate scheduling requirements"
    messages:
      - "I need a cardiology referral"
      - "No emergency"
      - "Dr. Sarah Johnson from Denver"
      - "Patient: Bob Wilson, DOB 03/10/1970, (555) 777-9999, bob@email.com"
      - "Chronic angina, on nitro patches"
      - "Medicare, ID: MED123456"
      - "I can only do Friday afternoons"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["Monday", "Thursday", "not available"]
    max_turns: 8

partial_information_scenarios:
  - scenario: "missing_insurance"
    description: "Referral with missing insurance information"
    messages:
      - "I need a referral"
      - "No emergency"
      - "Dr. Emily Brown from Boston"
      - "Patient: Lisa Chen, DOB 07/30/1985, (617) 555-3333, lisa@email.com"
      - "Palpitations and dizziness for 1 month"
      - "I don't have my insurance card with me"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["insurance", "required"]
    max_turns: 7

  - scenario: "provider_needs_clarification"
    description: "Multiple providers found, needs clarification"
    messages:
      - "I need a cardiology referral"
      - "Not an emergency"
      - "Dr. Josh Mandel"
      - "He's the one in New York"
      - "Patient: Mark Davis, DOB 11/11/1975, (212) 555-4444, mark@email.com"
      - "Hypertension and chest discomfort"
      - "Blue Cross, ID: BC789456"
      - "Monday at noon"
    expected_outcome: "[REFERRAL_COMPLETE]"
    max_turns: 9

edge_cases:
  - scenario: "npi_mismatch"
    description: "Provided NPI doesn't match provider name"
    messages:
      - "I need a referral"
      - "No emergency"
      - "Dr. Sarah Johnson, NPI 9999999999"
    expected_outcome: "[NEED_MORE_INFO]"
    expected_content: ["mismatch", "verify", "correct"]
    max_turns: 4

  - scenario: "immediate_emergency_flag"
    description: "Emergency mentioned immediately"
    messages:
      - "I need an emergency cardiology appointment, having chest pain now"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["911", "emergency"]
    max_turns: 1

  - scenario: "valid_then_invalid_scheduling"
    description: "Provides valid info then invalid scheduling"
    messages:
      - "I need a referral"
      - "No emergency"
      - "Dr. Robert Lee from Seattle"
      - "Jane Smith, DOB 02/28/1960, (206) 555-7777, jane@email.com"
      - "Irregular heartbeat for 2 months"
      - "Cigna, ID: CIG345678"
      - "Actually, I can only do weekends"
    expected_outcome: "[REFERRAL_FAILED]"
    expected_content: ["Monday", "Thursday", "available"]
    max_turns: 8